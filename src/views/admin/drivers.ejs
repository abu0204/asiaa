<%- include("../layouts/adminheaders") %> <%- include("../layouts/sidebar") %>
<link rel="stylesheet" href="/css/drivers.css">
<div class="container-fluid mt-4 ml-5">
  <h3 class="mb-4">Drivers List</h3>

  <div class="card">
    <div class="card-body">
      <table class="table table-bordered table-hover">
        <thead class="table-dark">
          <tr>
            <th>#</th>
            <th>Name</th>
            <th>Phone</th>
            <th>Verified</th>
            <th>Joined</th>
            <th>Action</th>
          </tr>
        </thead>
        <% console.log(data,"datadata") %>
        <tbody>
          <% if (data.length === 0) { %>
          <tr>
            <td colspan="6" class="text-center">No drivers found</td>
          </tr>
          <% } %> <% data.forEach((driver, index) => { %>
          <tr>
            <td><%= index + 1 %></td>
            <td><%= driver.name %></td>
            <td><%= driver.phone %></td>
            <td>
              <% if (driver.isVerified) { %>
              <span class="badge bg-success">Verified</span>
              <% } else { %>
              <span class="badge bg-warning text-dark">Pending</span>
              <% } %>
            </td>
            <td><%= new Date(driver.createdAt).toLocaleDateString() %></td>
            <td>
              <a
                href="/admin/drivers/<%= driver._id %>"
                class="btn btn-sm btn-info"
              >
                View
              </a>
              <button
                class="btn btn-sm btn-danger"
                onclick="deleteDriver('<%= driver._id %>')"
              >
                Approve
              </button>
            </td>
          </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  </div>
</div>


<script>
  function deleteDriver(id) {
    if (!confirm("Are you sure you want to delete this driver?")) return;

    fetch(`/admin/drivers/${id}`, {
      method: "DELETE",
    })
      .then((res) => res.json())
      .then((data) => {
        alert(data.message);
        if (data.success) location.reload();
      });
  }
</script>

<%- include("../layouts/adminfooter") %>
